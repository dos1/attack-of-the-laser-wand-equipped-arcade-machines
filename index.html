<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Attack of the Laser Wand Equipped Arcade Machines</title>
    <script src="aframe.min.js"></script>
    <script src="aframe-gif-shader.min.js"></script>
    <script src="aframe-look-at-component.min.js"></script>
    <script src="alleg.js"></script>
    <script src="logo.js"></script>
    <script src="jquery-3.2.1.min.js"></script>
    <script src="game.js"></script>
    <style>
        .loading { 
            color: white;
            background-color: black;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            text-align: center;
            box-sizing: border-box;
            padding-top: 48vh;
            z-index: 9999;
            font-size: 4vh;
            font-family: sans-serif;
        }
        .assets {
            display: none;
        }
        .a-pointing canvas { cursor: pointer; }
        .a-enter-vr-button {
  animation: 4s ease-out 12s waggle;
  animation-iteration-count: infinite;
}
@keyframes waggle {
  0% {
    transform: none;
  }
  12.5% {
    transform: rotateZ(-20deg) scale(1.2);
  }
  15% {
    transform: rotateZ(25deg) scale(1.2);
  }
  16.875% {
    transform: rotateZ(-15deg) scale(1.2);
  }
  18.75% {
    transform: rotateZ(15deg) scale(1.2);
  }
  20.625% {
    transform: rotateZ(-12deg) scale(1.2);
  }
  21.25% {
    transform: rotateZ(0) scale(1.2);
  }
  25%, 100% {
    transform: rotateZ(0) scale(1);
  }
}

    </style>
  </head>
  <body>
    <div class="loading">Loading...</div>
    <div class="assets">
        <canvas id="logo_canvas" width="320" height="180"></canvas>
        <canvas id="glcanvas" width="320" height="180"></canvas>
    </div>
    <a-scene yes-this-is-awful-code>
      <a-assets timeout="8000">
        <video id="discovr" src="bg.mp4" preload="auto" webkit-playsinline autoplay loop></video>
        <img id="frame" src="frame.png" />
        <img id="wood" src="wood.jpg" />
        <img id="dosowisko" src="dosowisko.png" />
        <img id="buttons" src="buttons.png" />
        <img id="coiner" src="coiner.png" />
        <img src="coin.png" />
        <img src="logo.png" />
        <img src="exterminate.png" />
        <a-asset-item src="explosion.gif" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="dosowisko.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="kbd.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="key.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/1.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/2.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/3.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/4.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/5.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/6.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/7.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/8.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/9.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/10.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/11.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="spells/12.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="down.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="touch.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="explosions/1.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="explosions/2.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="explosions/3.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="explosions/4.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="explosions/5.ogg" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="DejaVuSansMono.ttf" response-type="arraybuffer"></a-asset-item>
        <a-asset-item src="vertex.glsl" id="vertexshader"></a-asset-item>
        <a-asset-item src="fragment.glsl" id="fragmentshader"></a-asset-item>
        <a-asset-item src="music.ogg" response-type="arraybuffer"></a-asset-item>
      </a-assets>
<!--      <a-box shadow="cast:true;receive:true;" position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sphere shadow="cast:true;receive:true;" position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-cylinder shadow="cast:true;receive:true;" position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane shadow="cast:true;receive:true;" position="0 0.1 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>


      <a-box shadow="cast:true;receive:true;" position="0 1 -2" scale="0.7 0.7 0.7" color="#4CC3D9" src="#discovr"></a-box>
-->

      <a-plane position="0 2.5 -25" material="transparent: true; side: double" src="frame.png" repeat="10 1" rotation="0 0 0" width="50" height="5"></a-plane>
      <a-plane position="0 2.5 25" material="transparent: true; side: double" src="frame.png" repeat="10 1" width="50" height="5"></a-plane>
      <a-plane position="25 2.5 0" rotation="0 -90 0" material="transparent: true; side: double" src="frame.png" repeat="10 1" width="50" height="5"></a-plane>
      <a-plane position="-25 2.5 0" rotation="0 -90 0" material="transparent: true; side: double" src="frame.png" repeat="10 1" width="50" height="5"></a-plane>

      <a-entity position="0 9 -1.5" class="arcade" id="arcade-template">
        <a-entity anim-listener class="aggregated-position">
            <a-animation class="spawn" attribute="position" dur="2000"
                    from="0 100 0" to="0 0 0"
                    begin="spawn" easing="ease-in" fill="both">
                    </a-animation>
            <a-sound src="url(touch.ogg)" class="touchsound" poolSize="1" volume="5" rolloffFactor="0.5"></a-sound>

            <a-entity anim-listener class="anim-position">
                <a-animation attribute="position" dur="1500" delay="500"
                        from="0 0 0" to="0 0 1"
                        begin="jump" repeat="0" easing="linear" fill="both" class="jump">
                        </a-animation>
                <a-entity position="0 0.6 0" class="machine" anim-listener>
                    
                        <a-animation attribute="position" dur="1000"
                        from="0 0.6 0" to="0 1.5 0"
                        begin="jump" easing="ease-in-back" repeat="1" direction="alternate">
                        </a-animation>
                        <a-animation class="anim2" attribute="scale" dur="1200"
                        from="1 1 1" to="0.9 1.25 1"
                        begin="jump" easing="ease-in-back">
                        </a-animation>
                        <a-animation attribute="scale" dur="1400"
                        from="0.9 1.25 1" to="1 1 1"
                        begin="jump2" class="jump2" easing="ease-out-bounce">
                        </a-animation>

                    <a-plane position="0 0.751 0.3" rotation="-90 0 0" material="transparent: true; side: double" width="0.8" height="0.325" src="#buttons" shadow="cast:false;receive:true;"></a-plane>         

                    <a-box position="0 0.575 0" width="1" height="2.35" depth="0.79" class="bounding" material="transparent: true; opacity: 0;"></a-box>
                
                    <a-box position="0 0.575 -0.125" width="1" height="2.35" depth="0.5" color="gray" material="side: back; shader: flat"></a-box>

                    <a-box position="0 0 0" width="1" height="1.2" depth="0.75" color="gray" gray shadow="cast:true;receive:true;"></a-box> 

                    <a-box position="0 0.675 0.05" width="1" height="0.15" depth="0.85" color="gray" gray shadow="cast:true;receive:true;"></a-box> 
                    
                    <a-entity position="-0.45 0.675 0.475" class="wand" visible="false">
                        <a-animation attribute="rotation" dur="2000"
                        from="-45 0 0" to="45 0 0"
                        repeat="indefinite" easing="ease-in-out" direction="alternate"></a-animation>
                        
                        <a-entity>
                            <a-animation attribute="rotation" dur="1500"
                            from="0 -45 0" to="0 45 0"
                            repeat="indefinite" easing="ease-in-out" direction="alternate"></a-animation>
                            
                            <a-cylinder color="brown" height="0.2" radius="0.01" position="0 0 0.1" rotation="90 0 0"></a-cylinder>
                            <a-entity position="0 0 0.2">
                                <a-entity line="start:0 0 0;end:0 0 6;color: red; opacity: 0.5"></a-entity>
                            </a-entity>
                        </a-entity>
                    </a-entity>
                    
                    <a-box position="0 1.0625 -0.125" width="1" height="0.625" depth="0.5" color="gray" gray shadow="cast:true;receive:true;"></a-box> 

                    <a-plane position="0 1.0625 0.126" width="1" height="0.625" src="#glcanvas" shadow="cast:false;receive:false;"></a-plane> 

                    <a-box position="-0.45 1.0625 0.25" width="0.1" height="0.625" depth="0.25" color="gray" gray shadow="cast:true;receive:true;"></a-box> 
                    <a-box position="0.45 1.0625 0.25" width="0.1" height="0.625" depth="0.25" color="gray" gray shadow="cast:true;receive:true;"></a-box> 
                    <a-box position="0 1.5625 0.025" width="1" height="0.375" depth="0.8" color="gray" gray shadow="cast:true;receive:true;"></a-box> 

                    <a-plane position="0 1.5625 0.426" width="0.95" height="0.325" src="#dosowisko" shadow="cast:false;receive:true;"></a-plane> 

                    <a-plane position="0.375 0.35 0.3751" width="0.025" height="0.1" src="#coiner" shadow="cast:false;receive:true;" class="clickable" coin-listener>
                        <a-cylinder class="c" color="yellow" height="0.00175" radius="0.025" position="0 0 0" rotation="0 0 90" visible="false"></a-cylinder>
                    </a-plane> 
                    

                    <a-sound src="url(down.ogg)" id="audio-down" sound="rolloffFactor: 0.25" volume="1"></a-sound>
                </a-entity>
                <a-plane class="explosion" look-at="#camera" visible="false" width="3" height="6" material="shader: gif; src:url(explosion.gif);transparent: true; side: double">
                    <a-sound src="url(explosions/4.ogg)" class="sound" volume="1" sound="poolSize:4; rolloffFactor:0.5"></a-sound>
                </a-plane>
            </a-entity>
        </a-entity>
      </a-entity>
      
      
      <a-box shadow="receive:true;" position="0 -0.5 0" rotation="-90 0 0" width="50" height="50" src="#wood"></a-box>

      <a-box position="0 -501 0" rotation="0 0 0" width="10" height="1000" depth="10" src="#wood"></a-box>

      
      
      
      <a-videosphere position="0 20 0" src="#discovr" radius="100"></a-videosphere>

      <a-entity position="0 0 0" rotation="0 0 0" class="position">
        <a-entity position="0 0 0" rotation="0 0 0" class="rotation">
            <a-entity position="0 0 0" rotation="0 0 0" class="screenshake">
                <a-entity id="camera" camera-listener camera="userHeight: 1.6" cursor="rayOrigin: mouse; fuseTimeout: 1000" raycaster="far: 6; objects: .clickable">
                    <a-sound position="0 0 -0.1" src="url(music.ogg)" id="music" loop="true" sound="rolloffFactor:0"></a-sound>
                    <a-entity class="keyboard-helper" position="0 0 -0.25">
                    </a-entity>
                </a-entity>
            </a-entity>
            <a-entity laser-controls="hand: right" raycaster="far: 6; objects: .clickable" trigger-listener></a-entity>
        </a-entity>
      </a-entity>

    </a-scene>
    
  </body>
</html>
